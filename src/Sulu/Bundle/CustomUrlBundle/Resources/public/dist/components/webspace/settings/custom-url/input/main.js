define(["underscore"],function(a){"use strict";var b={templates:{input:'<input type="text" data-index="<%=index%>" <% if (index === 0) { %>data-prefix="true"<% } else { %>data-suffix="true"<% } %>/>',text:"<span><%=text%></span>"}},c=function(a){if(!a)return[];for(var b=a.split("*"),c=b.length-("*"===a.charAt(a.length-1)?2:1);c>=1;c-=2)""!==b[c]&&""!==b[c-1]&&b.splice(c,0,"");var d=a.concat("/");return-1===d.substring(d.indexOf("/")).indexOf("*")&&(b[b.length-1]=b[b.length-1].concat("/"),b.push("")),b},d="sulu.webspace-settings.custom-url.";return{defaults:b,events:{names:{setBaseDomain:{postFix:"set-base-domain",type:"on"}},namespace:d},initialize:function(){this.render(this.options.baseDomain),this.setDomData(this.$el.data("custom-url-data")||{}),this.bindDomEvents(),this.bindCustomEvents()},bindCustomEvents:function(){this.events.setBaseDomain(this.setBaseDomain.bind(this))},bindDomEvents:function(){this.$el.on("data-changed",function(){this.setBaseDomain(this.$el.data("custom-url-data"))}.bind(this)),this.$el.on("change","input",function(){this.$el.data("custom-url-data",this.getData())}.bind(this))},render:function(b){this.baseDomain=b,null!==this.baseDomain&&(this.domainParts=c(this.baseDomain),this.html(a.map(this.domainParts,this.renderDomainPart.bind(this))))},renderDomainPart:function(a,b){switch(a){case"":return this.templates.input({index:b});default:return this.templates.text({text:a})}},setBaseDomain:function(a){var b=this.getData();this.render(a),this.setDomData(b)},getData:function(){var b=$('input[data-prefix="true"]').val()||"",c=a.map($('input[data-suffix="true"]'),function(a){return $(a).val()});return{prefix:b,suffix:c}},setDomData:function(b){$('input[data-prefix="true"]').val(b.prefix||""),a.map($('input[data-suffix="true"]'),function(a,c){return $(a).val(b.suffix[c]||"")}),this.$el.data("custom-url-data",this.getData())}}});